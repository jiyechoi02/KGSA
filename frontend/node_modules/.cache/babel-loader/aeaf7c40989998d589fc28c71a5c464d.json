{"ast":null,"code":"var _jsxFileName = \"/Users/jiyechoi/Desktop/KGSA_web/kgsa/frontend/src/components/pages/Market.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { useHistory, useParams } from 'react-router-dom';\nimport { Row, Modal, Col } from \"react-bootstrap\";\nimport { CustomContainer as Container } from '../CustomContainer';\nimport MyTable from \"../MyTable\";\nimport MyModal from '../MyModal';\nimport MySpinner from '../MySpinner';\nimport { StyledButton as Button } from '../Styles';\nimport ViewPost from '../ViewPost';\nimport Comments from '../Comments';\nimport { RiArrowGoBackFill } from 'react-icons/ri';\nimport { getUser, getToken } from '../../services/LoginHelper';\nimport Editor from \"../Editor\";\nimport { useFetch } from \"../../services/UseAPIs\";\nimport MyDiv from \"../MyDiv\";\nimport EditPost from \"../EditPost\";\nimport { url } from '../../services/config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst user = getUser();\nexport const MarketEditPost = () => {\n  _s();\n\n  const {\n    _id\n  } = useParams();\n  let data = null;\n  const {\n    response,\n    isLoading,\n    error\n  } = useFetch(`${url}market/posts/${_id}`);\n  useEffect(() => {\n    if (response) {\n      if (response.success) {\n        data = {\n          title: response.data.title,\n          contents: response.data.contents,\n          username: response.data.username,\n          price: response.data.price,\n          keys: response.data.keys\n        };\n      }\n    }\n  }, [response]);\n\n  const updataData = (dataToUpdate, dispatch) => {\n    var requestOptions = {\n      method: 'PUT',\n      body: dataToUpdate,\n      redirect: 'follow'\n    };\n    fetch(`${url}market/${_id}`, requestOptions).then(res => res.json()).then(res => {\n      if (res.success) {\n        dispatch({\n          type: \"success\",\n          value: true\n        });\n      } else dispatch({\n        type: \"fail\",\n        value: true\n      });\n    }).catch(error => dispatch({\n      type: \"fail\",\n      value: true\n    })).finally(() => {\n      dispatch({\n        type: \"loading\",\n        value: false\n      });\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: /*#__PURE__*/_jsxDEV(MyDiv, {\n      children: [/*#__PURE__*/_jsxDEV(Container, {\n        containerSize: \"myContainer--small\",\n        children: \"\\uBCBC\\uB8E9\\uC2DC\\uC7A5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this), response && /*#__PURE__*/_jsxDEV(EditPost, {\n        onSubmit: updataData,\n        initialData: data,\n        price: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 30\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 9\n  }, this);\n};\n\n_s(MarketEditPost, \"nALXCbloNjUMFJcEp+zIFqyNQVA=\", false, function () {\n  return [useParams, useFetch];\n});\n\n_c = MarketEditPost;\nexport const MarketNewPost = () => {\n  const postData = (data, dispatch) => {\n    var myHeaders = new Headers();\n    var requestOptions = {\n      method: 'POST',\n      body: data,\n      redirect: 'follow'\n    };\n    fetch(url + 'market', requestOptions).then(res => res.json()).then(res => {\n      if (res.success) {\n        dispatch({\n          type: \"success\",\n          value: true\n        });\n      } else dispatch({\n        type: \"fail\",\n        value: true\n      });\n    }).catch(error => dispatch({\n      type: \"fail\",\n      value: true\n    })).finally(() => {\n      dispatch({\n        type: \"loading\",\n        value: false\n      });\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: /*#__PURE__*/_jsxDEV(MyDiv, {\n      children: [/*#__PURE__*/_jsxDEV(Container, {\n        containerSize: \"myContainer--small\",\n        children: \"\\uBCBC\\uB8E9\\uC2DC\\uC7A5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Editor, {\n        price: true,\n        onSubmit: postData,\n        address: true,\n        initialData: {\n          username: user.username\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 9\n  }, this);\n};\n_c2 = MarketNewPost;\nexport const MarketPostView = () => {\n  _s2();\n\n  const {\n    _id\n  } = useParams();\n  const [isDeleted, setIsDeleted] = useState(false);\n  const [showConfirm, setShowConfirm] = useState(false);\n  const history = useHistory(); // const [data, setData] =useState();\n\n  let data = null;\n  const {\n    response,\n    isLoading,\n    error\n  } = useFetch(`${url}market/posts/${_id}`);\n  useEffect(() => {\n    if (response) {\n      if (response.success) data = response.data;\n    }\n  }, [response]);\n\n  const handleGoBack = () => {\n    // go back to announcement page\n    // history.push('/market');\n    history.goBack();\n  };\n\n  const handleDelete = () => {\n    setShowConfirm(true);\n  };\n\n  const deletePost = () => {\n    var requestOptions = {\n      method: 'DELETE',\n      redirect: 'follow'\n    };\n    fetch(`${url}market/${_id}/${user.username}`, requestOptions).then(res => res.json()).then(() => setIsDeleted(true)).catch(error => console.log('error', error));\n  };\n\n  const handleUpdate = () => {\n    history.push(`/market/edit/${_id}`);\n  };\n\n  const updateViews = () => {\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n    var requestOptions = {\n      method: 'PUT',\n      redirect: 'follow'\n    };\n    fetch(`${url}market/views/${_id}`, requestOptions).then(res => res.text()).catch(err => console.log('err', err));\n  };\n\n  useEffect(() => {\n    updateViews();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [!data ? /*#__PURE__*/_jsxDEV(MySpinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 25\n    }, this) : /*#__PURE__*/_jsxDEV(MyDiv, {\n      children: [/*#__PURE__*/_jsxDEV(Container, {\n        containerSize: \"myContainer--small\",\n        children: \"\\uBCBC\\uB8E9\\uC2DC\\uC7A5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          lg: 5,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleGoBack,\n            children: [/*#__PURE__*/_jsxDEV(RiArrowGoBackFill, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 60\n            }, this), \" Back\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 21\n      }, this), data && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(ViewPost, {\n            data: data,\n            handleDelete: handleDelete,\n            handleUpdate: handleUpdate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Row, {\n          children: /*#__PURE__*/_jsxDEV(Comments, {\n            forumItem: \"market\",\n            _id: _id\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(MyModal, {\n      show: isDeleted,\n      handleOnClick: handleGoBack,\n      variant: \"success\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"The post has been deleted successfully\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(MyModal, {\n      show: showConfirm,\n      handleOnClick: () => setShowConfirm(false),\n      children: /*#__PURE__*/_jsxDEV(Modal.Body, {\n        style: {\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Are you sure about that??\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          margin: \"0px\",\n          onClick: deletePost,\n          children: \"Confirm\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 25\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 167,\n    columnNumber: 13\n  }, this);\n};\n\n_s2(MarketPostView, \"zBzg84Hp4T1gjWeoxnPaZJM55Ro=\", false, function () {\n  return [useParams, useHistory, useFetch];\n});\n\n_c3 = MarketPostView;\nexport const Market = () => {\n  _s3();\n\n  const {\n    response,\n    isLoading,\n    erro\n  } = useFetch(url + \"market\");\n  const token = getToken();\n  const history = useHistory();\n\n  const handleClick = () => {\n    history.push(`/market/post`);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: !response ? /*#__PURE__*/_jsxDEV(MySpinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 25\n    }, this) : /*#__PURE__*/_jsxDEV(MyDiv, {\n      children: [/*#__PURE__*/_jsxDEV(Container, {\n        containerSize: \"myContainer--small\",\n        children: \"\\uBCBC\\uB8E9\\uC2DC\\uC7A5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleClick,\n            disabled: !token ? true : false,\n            children: \"New Post\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: response && /*#__PURE__*/_jsxDEV(MyTable, {\n          simple: false,\n          notices: response.notices,\n          data: response.posts,\n          url: \"market\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 38\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 211,\n    columnNumber: 9\n  }, this);\n};\n\n_s3(Market, \"058FdKJZHgf9oiTKHeb5hInRBSg=\", false, function () {\n  return [useFetch, useHistory];\n});\n\n_c4 = Market;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"MarketEditPost\");\n$RefreshReg$(_c2, \"MarketNewPost\");\n$RefreshReg$(_c3, \"MarketPostView\");\n$RefreshReg$(_c4, \"Market\");","map":{"version":3,"sources":["/Users/jiyechoi/Desktop/KGSA_web/kgsa/frontend/src/components/pages/Market.js"],"names":["useEffect","useState","useHistory","useParams","Row","Modal","Col","CustomContainer","Container","MyTable","MyModal","MySpinner","StyledButton","Button","ViewPost","Comments","RiArrowGoBackFill","getUser","getToken","Editor","useFetch","MyDiv","EditPost","url","user","MarketEditPost","_id","data","response","isLoading","error","success","title","contents","username","price","keys","updataData","dataToUpdate","dispatch","requestOptions","method","body","redirect","fetch","then","res","json","type","value","catch","finally","MarketNewPost","postData","myHeaders","Headers","MarketPostView","isDeleted","setIsDeleted","showConfirm","setShowConfirm","history","handleGoBack","goBack","handleDelete","deletePost","console","log","handleUpdate","push","updateViews","append","text","err","textAlign","Market","erro","token","handleClick","notices","posts"],"mappings":";;;;;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,SAASC,UAAT,EAAqBC,SAArB,QAAsC,kBAAtC;AACA,SAASC,GAAT,EAAaC,KAAb,EAAoBC,GAApB,QAA8B,iBAA9B;AACA,SAASC,eAAe,IAAIC,SAA5B,QAA6C,oBAA7C;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,OAAOC,SAAP,MAAsB,cAAtB;AACA,SAAQC,YAAY,IAAIC,MAAxB,QAAqC,WAArC;AACA,OAAOC,QAAP,MAAqB,aAArB;AACA,OAAOC,QAAP,MAAqB,aAArB;AACA,SAAQC,iBAAR,QAAgC,gBAAhC;AACA,SAAQC,OAAR,EAAgBC,QAAhB,QAA+B,4BAA/B;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,SAASC,QAAT,QAAyB,wBAAzB;AACA,OAAOC,KAAP,MAAkB,UAAlB;AACA,OAAOC,QAAP,MAAqB,aAArB;AACA,SAAQC,GAAR,QAAkB,uBAAlB;;;AAEA,MAAMC,IAAI,GAAGP,OAAO,EAApB;AAEA,OAAO,MAAMQ,cAAc,GAAG,MAAI;AAAA;;AAC9B,QAAM;AAACC,IAAAA;AAAD,MAAQvB,SAAS,EAAvB;AACA,MAAIwB,IAAI,GAAE,IAAV;AACA,QAAM;AAACC,IAAAA,QAAD;AAAWC,IAAAA,SAAX;AAAsBC,IAAAA;AAAtB,MAA+BV,QAAQ,CAAE,GAAEG,GAAI,gBAAeG,GAAI,EAA3B,CAA7C;AAEA1B,EAAAA,SAAS,CAAC,MAAI;AACV,QAAG4B,QAAH,EAAY;AACR,UAAGA,QAAQ,CAACG,OAAZ,EAAqB;AACjBJ,QAAAA,IAAI,GAAG;AACHK,UAAAA,KAAK,EAAGJ,QAAQ,CAACD,IAAT,CAAcK,KADnB;AAEHC,UAAAA,QAAQ,EAAGL,QAAQ,CAACD,IAAT,CAAcM,QAFtB;AAGHC,UAAAA,QAAQ,EAAGN,QAAQ,CAACD,IAAT,CAAcO,QAHtB;AAIHC,UAAAA,KAAK,EAAGP,QAAQ,CAACD,IAAT,CAAcQ,KAJnB;AAKHC,UAAAA,IAAI,EAAGR,QAAQ,CAACD,IAAT,CAAcS;AALlB,SAAP;AAOH;AACJ;AACJ,GAZQ,EAYP,CAACR,QAAD,CAZO,CAAT;;AAeA,QAAMS,UAAU,GAAG,CAACC,YAAD,EAAcC,QAAd,KAA0B;AAEzC,QAAIC,cAAc,GAAG;AACjBC,MAAAA,MAAM,EAAG,KADQ;AAEjBC,MAAAA,IAAI,EAAGJ,YAFU;AAGjBK,MAAAA,QAAQ,EAAE;AAHO,KAArB;AAMAC,IAAAA,KAAK,CAAE,GAAErB,GAAI,UAASG,GAAI,EAArB,EAAuBc,cAAvB,CAAL,CACCK,IADD,CACMC,GAAG,IAAEA,GAAG,CAACC,IAAJ,EADX,EAECF,IAFD,CAEMC,GAAG,IAAE;AACP,UAAGA,GAAG,CAACf,OAAP,EAAe;AACPQ,QAAAA,QAAQ,CAAC;AAACS,UAAAA,IAAI,EAAC,SAAN;AAAiBC,UAAAA,KAAK,EAAC;AAAvB,SAAD,CAAR;AACP,OAFD,MAGKV,QAAQ,CAAC;AAACS,QAAAA,IAAI,EAAC,MAAN;AAAcC,QAAAA,KAAK,EAAC;AAApB,OAAD,CAAR;AACR,KAPD,EAQCC,KARD,CAQOpB,KAAK,IAAIS,QAAQ,CAAC;AAACS,MAAAA,IAAI,EAAC,MAAN;AAAcC,MAAAA,KAAK,EAAC;AAApB,KAAD,CARxB,EASCE,OATD,CASS,MAAI;AACTZ,MAAAA,QAAQ,CAAC;AAACS,QAAAA,IAAI,EAAC,SAAN;AAAiBC,QAAAA,KAAK,EAAC;AAAvB,OAAD,CAAR;AACH,KAXD;AAYH,GApBD;;AAsBA,sBACI,QAAC,SAAD;AAAA,2BACI,QAAC,KAAD;AAAA,8BACI,QAAC,SAAD;AAAW,QAAA,aAAa,EAAC,oBAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,EAEKrB,QAAQ,iBAAI,QAAC,QAAD;AAAU,QAAA,QAAQ,EAAES,UAApB;AAAgC,QAAA,WAAW,EAAEV,IAA7C;AAAmD,QAAA,KAAK,EAAE;AAA1D;AAAA;AAAA;AAAA;AAAA,cAFjB;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,UADJ;AAQH,CAlDM;;GAAMF,c;UACKtB,S,EAEuBiB,Q;;;KAH5BK,c;AAmDb,OAAO,MAAM2B,aAAa,GAAG,MAAI;AAE7B,QAAMC,QAAQ,GAAG,CAAC1B,IAAD,EAAMY,QAAN,KAAiB;AAC9B,QAAIe,SAAS,GAAG,IAAIC,OAAJ,EAAhB;AAEA,QAAIf,cAAc,GAAG;AACjBC,MAAAA,MAAM,EAAE,MADS;AAEjBC,MAAAA,IAAI,EAAEf,IAFW;AAGjBgB,MAAAA,QAAQ,EAAE;AAHO,KAArB;AAKAC,IAAAA,KAAK,CAACrB,GAAG,GAAC,QAAL,EAAeiB,cAAf,CAAL,CACCK,IADD,CACMC,GAAG,IAAEA,GAAG,CAACC,IAAJ,EADX,EAECF,IAFD,CAEMC,GAAG,IAAE;AACP,UAAGA,GAAG,CAACf,OAAP,EAAe;AACPQ,QAAAA,QAAQ,CAAC;AAACS,UAAAA,IAAI,EAAC,SAAN;AAAiBC,UAAAA,KAAK,EAAC;AAAvB,SAAD,CAAR;AACP,OAFD,MAGKV,QAAQ,CAAC;AAACS,QAAAA,IAAI,EAAC,MAAN;AAAcC,QAAAA,KAAK,EAAC;AAApB,OAAD,CAAR;AACR,KAPD,EAQCC,KARD,CAQOpB,KAAK,IAAIS,QAAQ,CAAC;AAACS,MAAAA,IAAI,EAAC,MAAN;AAAcC,MAAAA,KAAK,EAAC;AAApB,KAAD,CARxB,EASCE,OATD,CASS,MAAI;AACTZ,MAAAA,QAAQ,CAAC;AAACS,QAAAA,IAAI,EAAC,SAAN;AAAiBC,QAAAA,KAAK,EAAC;AAAvB,OAAD,CAAR;AACH,KAXD;AAYH,GApBD;;AAqBA,sBACI,QAAC,SAAD;AAAA,2BACI,QAAC,KAAD;AAAA,8BACI,QAAC,SAAD;AAAW,QAAA,aAAa,EAAC,oBAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI,QAAC,MAAD;AAAQ,QAAA,KAAK,EAAE,IAAf;AAAqB,QAAA,QAAQ,EAAEI,QAA/B;AAAyC,QAAA,OAAO,EAAE,IAAlD;AAAwD,QAAA,WAAW,EAAE;AAACnB,UAAAA,QAAQ,EAACV,IAAI,CAACU;AAAf;AAArE;AAAA;AAAA;AAAA;AAAA,cAFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,UADJ;AAQH,CA/BM;MAAMkB,a;AAiCb,OAAO,MAAMI,cAAc,GAAG,MAAK;AAAA;;AAC/B,QAAM;AAAE9B,IAAAA;AAAF,MAAUvB,SAAS,EAAzB;AACA,QAAM,CAACsD,SAAD,EAAYC,YAAZ,IAA4BzD,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAAE0D,WAAF,EAAeC,cAAf,IAAiC3D,QAAQ,CAAC,KAAD,CAA/C;AACA,QAAM4D,OAAO,GAAG3D,UAAU,EAA1B,CAJ+B,CAK/B;;AAEA,MAAIyB,IAAI,GAAG,IAAX;AACA,QAAM;AAACC,IAAAA,QAAD;AAAWC,IAAAA,SAAX;AAAsBC,IAAAA;AAAtB,MAA+BV,QAAQ,CAAE,GAAEG,GAAI,gBAAeG,GAAI,EAA3B,CAA7C;AAEA1B,EAAAA,SAAS,CAAC,MAAI;AACV,QAAG4B,QAAH,EAAa;AACT,UAAGA,QAAQ,CAACG,OAAZ,EACIJ,IAAI,GAAGC,QAAQ,CAACD,IAAhB;AACP;AAEJ,GANQ,EAMP,CAACC,QAAD,CANO,CAAT;;AAQA,QAAMkC,YAAY,GAAG,MAAK;AACtB;AACA;AACAD,IAAAA,OAAO,CAACE,MAAR;AACH,GAJD;;AAMA,QAAMC,YAAY,GAAG,MAAI;AACrBJ,IAAAA,cAAc,CAAC,IAAD,CAAd;AACH,GAFD;;AAIA,QAAMK,UAAU,GAAG,MAAI;AACnB,QAAIzB,cAAc,GAAG;AACjBC,MAAAA,MAAM,EAAG,QADQ;AAEjBE,MAAAA,QAAQ,EAAE;AAFO,KAArB;AAIAC,IAAAA,KAAK,CAAE,GAAErB,GAAI,UAASG,GAAI,IAAGF,IAAI,CAACU,QAAS,EAAtC,EAAwCM,cAAxC,CAAL,CACCK,IADD,CACMC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADb,EAECF,IAFD,CAEM,MAAMa,YAAY,CAAC,IAAD,CAFxB,EAGCR,KAHD,CAGOpB,KAAK,IAAIoC,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqBrC,KAArB,CAHhB;AAIH,GATD;;AAWA,QAAMsC,YAAY,GAAE,MAAI;AACpBP,IAAAA,OAAO,CAACQ,IAAR,CAAc,gBAAe3C,GAAI,EAAjC;AACH,GAFD;;AAIA,QAAM4C,WAAW,GAAG,MAAI;AACpB,QAAIhB,SAAS,GAAG,IAAIC,OAAJ,EAAhB;AACAD,IAAAA,SAAS,CAACiB,MAAV,CAAiB,cAAjB,EAAiC,kBAAjC;AAEA,QAAI/B,cAAc,GAAG;AACjBC,MAAAA,MAAM,EAAG,KADQ;AAEjBE,MAAAA,QAAQ,EAAE;AAFO,KAArB;AAKAC,IAAAA,KAAK,CAAE,GAAErB,GAAI,gBAAeG,GAAI,EAA3B,EAA6Bc,cAA7B,CAAL,CACCK,IADD,CACMC,GAAG,IAAEA,GAAG,CAAC0B,IAAJ,EADX,EAECtB,KAFD,CAEOuB,GAAG,IAAEP,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAkBM,GAAlB,CAFZ;AAIH,GAbD;;AAcAzE,EAAAA,SAAS,CAAC,MAAI;AACVsE,IAAAA,WAAW;AACd,GAFQ,EAEP,EAFO,CAAT;AAIA,sBACQ,QAAC,SAAD;AAAA,eACK,CAAC3C,IAAD,gBAAO,QAAC,SAAD;AAAA;AAAA;AAAA;AAAA,YAAP,gBACD,QAAC,KAAD;AAAA,8BACI,QAAC,SAAD;AAAW,QAAA,aAAa,EAAC,oBAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI,QAAC,GAAD;AAAA,+BACI,QAAC,GAAD;AAAK,UAAA,EAAE,EAAE,CAAT;AAAA,iCACI,QAAC,MAAD;AAAQ,YAAA,OAAO,EAAEmC,YAAjB;AAAA,oCAA+B,QAAC,iBAAD;AAAA;AAAA;AAAA;AAAA,oBAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cAFJ,EAOKnC,IAAI,iBACD;AAAA,gCACI,QAAC,GAAD;AAAA,iCACI,QAAC,QAAD;AAAU,YAAA,IAAI,EAAEA,IAAhB;AAAsB,YAAA,YAAY,EAAEqC,YAApC;AAAkD,YAAA,YAAY,EAAEI;AAAhE;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAII,QAAC,GAAD;AAAA,iCACI,QAAC,QAAD;AAAU,YAAA,SAAS,EAAC,QAApB;AAA6B,YAAA,GAAG,EAAE1C;AAAlC;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBAJJ;AAAA,sBARR;AAAA;AAAA;AAAA;AAAA;AAAA,YAFJ,eAqBI,QAAC,OAAD;AAAS,MAAA,IAAI,EAAE+B,SAAf;AAA0B,MAAA,aAAa,EAAEK,YAAzC;AAAuD,MAAA,OAAO,EAAC,SAA/D;AAAA,6BACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YArBJ,eAwBI,QAAC,OAAD;AAAS,MAAA,IAAI,EAAEH,WAAf;AAA4B,MAAA,aAAa,EAAE,MAAIC,cAAc,CAAC,KAAD,CAA7D;AAAA,6BACQ,QAAC,KAAD,CAAO,IAAP;AAAY,QAAA,KAAK,EAAE;AAACc,UAAAA,SAAS,EAAC;AAAX,SAAnB;AAAA,gCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,eAEI,QAAC,MAAD;AAAQ,UAAA,MAAM,EAAC,KAAf;AAAqB,UAAA,OAAO,EAAET,UAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADR;AAAA;AAAA;AAAA;AAAA,YAxBJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADR;AAiCH,CA9FM;;IAAMT,c;UACOrD,S,EAGAD,U,EAIqBkB,Q;;;MAR5BoC,c;AAgGb,OAAO,MAAMmB,MAAM,GAAG,MAAI;AAAA;;AACtB,QAAM;AAAC/C,IAAAA,QAAD;AAAWC,IAAAA,SAAX;AAAsB+C,IAAAA;AAAtB,MAA+BxD,QAAQ,CAACG,GAAG,GAAC,QAAL,CAA7C;AACA,QAAMsD,KAAK,GAAG3D,QAAQ,EAAtB;AACA,QAAM2C,OAAO,GAAG3D,UAAU,EAA1B;;AAEA,QAAM4E,WAAW,GAAG,MAAI;AACpBjB,IAAAA,OAAO,CAACQ,IAAR,CAAc,cAAd;AACH,GAFD;;AAIA,sBACI,QAAC,SAAD;AAAA,cACK,CAACzC,QAAD,gBAAW,QAAC,SAAD;AAAA;AAAA;AAAA;AAAA,YAAX,gBACG,QAAC,KAAD;AAAA,8BACI,QAAC,SAAD;AAAW,QAAA,aAAa,EAAC,oBAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI,QAAC,GAAD;AAAA,+BACI,QAAC,GAAD;AAAA,iCACI,QAAC,MAAD;AAAQ,YAAA,OAAO,EAAEkD,WAAjB;AAA8B,YAAA,QAAQ,EAAE,CAACD,KAAD,GAAQ,IAAR,GAAa,KAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cAFJ,eAOI,QAAC,GAAD;AAAA,kBACKjD,QAAQ,iBAAI,QAAC,OAAD;AAAS,UAAA,MAAM,EAAE,KAAjB;AAAwB,UAAA,OAAO,EAAEA,QAAQ,CAACmD,OAA1C;AAAmD,UAAA,IAAI,EAAEnD,QAAQ,CAACoD,KAAlE;AAAyE,UAAA,GAAG,EAAC;AAA7E;AAAA;AAAA;AAAA;AAAA;AADjB;AAAA;AAAA;AAAA;AAAA,cAPJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAFR;AAAA;AAAA;AAAA;AAAA,UADJ;AAiBH,CA1BM;;IAAML,M;UAC4BvD,Q,EAErBlB,U;;;MAHPyE,M","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useHistory, useParams } from 'react-router-dom';\nimport { Row,Modal ,Col} from \"react-bootstrap\";\nimport { CustomContainer as Container } from '../CustomContainer' ;\nimport MyTable from \"../MyTable\";\nimport MyModal from '../MyModal';\nimport MySpinner from '../MySpinner';\nimport {StyledButton as Button} from '../Styles';\nimport ViewPost from '../ViewPost';\nimport Comments from '../Comments';\nimport {RiArrowGoBackFill} from 'react-icons/ri';\nimport {getUser,getToken} from '../../services/LoginHelper';\nimport Editor from \"../Editor\";\nimport { useFetch } from \"../../services/UseAPIs\";\nimport MyDiv from \"../MyDiv\";\nimport EditPost from \"../EditPost\";\nimport {url} from '../../services/config';\n\nconst user = getUser()\n\nexport const MarketEditPost = ()=>{\n    const {_id} = useParams();\n    let data =null;\n    const {response, isLoading, error} = useFetch(`${url}market/posts/${_id}`)\n\n    useEffect(()=>{\n        if(response){\n            if(response.success) {\n                data = { \n                    title : response.data.title,\n                    contents : response.data.contents,\n                    username : response.data.username,\n                    price : response.data.price,\n                    keys : response.data.keys\n                }\n            }\n        }\n    },[response])\n\n\n    const updataData = (dataToUpdate,dispatch) =>{\n\n        var requestOptions = {\n            method : 'PUT', \n            body : dataToUpdate,\n            redirect: 'follow'\n        };\n\n        fetch(`${url}market/${_id}`,requestOptions)\n        .then(res=>res.json())\n        .then(res=>{\n            if(res.success){\n                    dispatch({type:\"success\", value:true})\n            }\n            else dispatch({type:\"fail\", value:true})\n        })\n        .catch(error => dispatch({type:\"fail\", value:true}))\n        .finally(()=>{\n            dispatch({type:\"loading\", value:false})\n        })\n    }\n    \n    return (\n        <Container>\n            <MyDiv>\n                <Container containerSize=\"myContainer--small\">벼룩시장</Container> \n                {response && <EditPost onSubmit={updataData} initialData={data} price={true}/>}\n            </MyDiv>\n        </Container>\n    )\n}\nexport const MarketNewPost = ()=>{\n\n    const postData = (data,dispatch)=>{\n        var myHeaders = new Headers();\n\n        var requestOptions = {\n            method: 'POST', \n            body: data,\n            redirect: 'follow'\n        };\n        fetch(url+'market', requestOptions)\n        .then(res=>res.json())\n        .then(res=>{\n            if(res.success){\n                    dispatch({type:\"success\", value:true})\n            }\n            else dispatch({type:\"fail\", value:true})\n        })\n        .catch(error => dispatch({type:\"fail\", value:true}))\n        .finally(()=>{\n            dispatch({type:\"loading\", value:false})\n        })\n    }\n    return(\n        <Container>\n            <MyDiv>\n                <Container containerSize=\"myContainer--small\">벼룩시장</Container>                \n                <Editor price={true} onSubmit={postData} address={true} initialData={{username:user.username}}/>\n            </MyDiv>\n        </Container>        \n    )\n}\n\nexport const MarketPostView = () =>{\n    const { _id } = useParams();\n    const [isDeleted, setIsDeleted] = useState(false);\n    const [ showConfirm, setShowConfirm] = useState(false);\n    const history = useHistory();\n    // const [data, setData] =useState();\n\n    let data = null;\n    const {response, isLoading, error} = useFetch(`${url}market/posts/${_id}`)\n    \n    useEffect(()=>{\n        if(response) {\n            if(response.success)\n                data = response.data\n        }\n    \n    },[response])\n    \n    const handleGoBack = () =>{\n        // go back to announcement page\n        // history.push('/market');\n        history.goBack();\n    }\n    \n    const handleDelete = ()=>{\n        setShowConfirm(true);\n    }   \n\n    const deletePost = ()=>{\n        var requestOptions = {\n            method : 'DELETE',\n            redirect: 'follow'\n        };\n        fetch(`${url}market/${_id}/${user.username}`,requestOptions)\n        .then(res => res.json())\n        .then(() => setIsDeleted(true))\n        .catch(error => console.log('error', error));\n    }\n    \n    const handleUpdate =()=>{\n        history.push(`/market/edit/${_id}`)\n    }\n\n    const updateViews = ()=>{\n        var myHeaders = new Headers();\n        myHeaders.append(\"Content-Type\", \"application/json\");\n        \n        var requestOptions = {\n            method : 'PUT',\n            redirect: 'follow'\n        };\n\n        fetch(`${url}market/views/${_id}`,requestOptions)\n        .then(res=>res.text())\n        .catch(err=>console.log('err',err));\n\n    }\n    useEffect(()=>{\n        updateViews();        \n    },[])\n\n    return(\n            <Container>\n                {!data? <MySpinner/> :\n                <MyDiv>\n                    <Container containerSize=\"myContainer--small\">벼룩시장</Container>\n                    <Row>\n                        <Col lg={5}>\n                            <Button onClick={handleGoBack}><RiArrowGoBackFill/> Back</Button>\n                        </Col>\n                    </Row>\n                    {data &&\n                        <>\n                            <Row>\n                                <ViewPost data={data} handleDelete={handleDelete} handleUpdate={handleUpdate}/>\n                            </Row>\n                            <Row>\n                                <Comments forumItem=\"market\" _id={_id}/>\n                            </Row>\n                        </>\n                    }    \n                </MyDiv>\n                }\n                <MyModal show={isDeleted} handleOnClick={handleGoBack} variant='success'>\n                    <p>The post has been deleted successfully</p>\n                </MyModal>\n                <MyModal show={showConfirm} handleOnClick={()=>setShowConfirm(false)}>\n                        <Modal.Body style={{textAlign:\"center\"}}>\n                            <p>Are you sure about that??</p>\n                            <Button margin=\"0px\" onClick={deletePost}>Confirm</Button>\n                        </Modal.Body>\n                </MyModal>                \n            </Container> \n    )\n}\n\nexport const Market = ()=>{\n    const {response, isLoading, erro } = useFetch(url+\"market\")\n    const token = getToken();\n    const history = useHistory();\n\n    const handleClick = ()=>{\n        history.push(`/market/post`)\n    }\n\n    return (\n        <Container>\n            {!response? <MySpinner/> :\n                <MyDiv>\n                    <Container containerSize=\"myContainer--small\">벼룩시장</Container>\n                    <Row>\n                        <Col>\n                            <Button onClick={handleClick} disabled={!token? true:false}>New Post</Button>\n                        </Col>\n                    </Row>\n                    <Row>\n                        {response && <MyTable simple={false} notices={response.notices} data={response.posts} url=\"market\"/>}\n                    </Row>\n                </MyDiv>\n            }\n        </Container>\n    )\n}\n\n"]},"metadata":{},"sourceType":"module"}