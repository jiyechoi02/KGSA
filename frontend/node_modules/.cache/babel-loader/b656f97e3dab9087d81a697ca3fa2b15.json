{"ast":null,"code":"var _jsxFileName = \"/Users/jiyechoi/Desktop/KGSA_web/kgsa/frontend/src/components/Comments.js\",\n    _s = $RefreshSig$();\n\n// import { Button } from \"bootstrap\";s\nimport { useEffect, useState } from \"react\";\nimport { Col, Form, ListGroup, Row, Alert } from \"react-bootstrap\";\nimport { RiDeleteBin2Line, RiEditLine } from 'react-icons/ri';\nimport { getToken, getUser } from \"../services/LoginHelper\";\nimport { StyledButton } from \"./Styles\";\nimport { BsChatQuote } from 'react-icons/bs';\nimport { useHistory } from \"react-router-dom\";\nimport { url } from '../services/config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst user = getUser();\n\nconst userCompare = username => {\n  return !user.username.localeCompare(username);\n};\n\nconst Comments = ({\n  forumItem,\n  _id\n}) => {\n  _s();\n\n  const user = getUser();\n  const [comments, setComments] = useState([]);\n  const [newComment, setNewComment] = useState({\n    username: user ? user.username : \"\",\n    comment: \"\"\n  });\n  const [inputKey, setInputKey] = useState(\"inputKey\");\n  const [editing, setEditing] = useState(false);\n  const history = useHistory();\n\n  const handleChange = e => {\n    setNewComment({ ...newComment,\n      comment: e.target.value\n    });\n  };\n\n  const handleOnSubmit = e => {\n    e.preventDefault();\n\n    if (!editing) {\n      addNewComment();\n    } else {\n      updateCommnet(newComment._id);\n    } // setInputKey(e.target.value);\n\n  };\n\n  const fetchData = () => {\n    var requestOptions = {\n      method: 'GET',\n      redirect: 'follow'\n    };\n    fetch(`${url}${forumItem}/comments/${_id}`, requestOptions).then(response => response.json()).then(result => {\n      setComments(result.data);\n    }).catch(error => console.log('error', error));\n  };\n\n  const addNewComment = () => {\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n    var requestOptions = {\n      method: 'POST',\n      headers: myHeaders,\n      body: JSON.stringify(newComment),\n      redirect: 'follow'\n    };\n    fetch(`${url}${forumItem}/comments/${_id}`, requestOptions).then(response => response.text()).then(res => setInputKey(res)).catch(error => console.log('error', error));\n  };\n\n  const updateCommnet = cid => {\n    console.log(\"?\");\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n    var requestOptions = {\n      method: 'PUT',\n      headers: myHeaders,\n      body: JSON.stringify(newComment),\n      redirect: 'follow'\n    };\n    fetch(`${url}${forumItem}/comments/${_id}/${cid}`, requestOptions).then(response => response.text()).then(res => setInputKey(res)).catch(error => console.log('error', error));\n    setEditing(false);\n  };\n\n  const deleteComment = cid => {\n    var requestOptions = {\n      method: 'DELETE',\n      redirect: 'follow'\n    };\n    fetch(`${url}${forumItem}/comments/${_id}/${cid}`, requestOptions).then(response => response.text()).then(res => setInputKey(res)).catch(error => console.log('error', error));\n    setEditing(false);\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, [inputKey]);\n\n  const renderForm = () => {\n    var value = \"\";\n    let component = null;\n\n    if (!getToken()) {\n      component = /*#__PURE__*/_jsxDEV(Alert, {\n        variant: \"danger\",\n        style: {\n          textAlign: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Please Login to make a comment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(StyledButton, {\n          onClick: () => history.push('/login'),\n          children: \"Go to Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 26\n      }, this);\n    } else {\n      component = /*#__PURE__*/_jsxDEV(Form, {\n        onSubmit: handleOnSubmit,\n        children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: !editing ? \"New comment\" : \"Edit comment\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            as: \"textarea\",\n            placeholder: \"Kindness and politeness are not overrated at all.\",\n            rows: 3,\n            name: \"comment\",\n            onChange: handleChange,\n            defaultValue: editing ? newComment.comment : null\n          }, inputKey, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(StyledButton, {\n          type: \"submit\",\n          float: \"right\",\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 26\n      }, this);\n    }\n\n    return component;\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(ListGroup, {\n      children: [comments.map((item, i) => {\n        return /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n          variant: \"secondary\",\n          children: /*#__PURE__*/_jsxDEV(Row, {\n            className: \"align-items-center\",\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              xs: 2,\n              children: /*#__PURE__*/_jsxDEV(BsChatQuote, {\n                style: {\n                  fontSize: \"25pt\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 154,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              xs: 7,\n              children: [/*#__PURE__*/_jsxDEV(Row, {\n                style: {\n                  fontSize: \"10pt\"\n                },\n                children: [\"user: \", item.username]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Row, {\n                style: {\n                  fontSize: \"12pt\"\n                },\n                children: item.comment\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              xs: 2,\n              style: {\n                fontSize: \"10pt\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(Row, {\n                children: \"\\uC791\\uC131\\uC2DC\\uAC04\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Row, {\n                children: item.updatedAt.split('T')[0]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 166,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Row, {\n                children: item.updatedAt.split('T')[1].substring(0, 11)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              xs: 1,\n              children: user && userCompare(item.username) ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(RiDeleteBin2Line, {\n                  onClick: () => {\n                    deleteComment(item._id);\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 176,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(RiEditLine, {\n                  onClick: () => {\n                    setEditing(true);\n                    setNewComment(item);\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 177,\n                  columnNumber: 49\n                }, this)]\n              }, void 0, true) : null\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 33\n          }, this)\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 29\n        }, this);\n      }), /*#__PURE__*/_jsxDEV(ListGroup.Item, {\n        variant: \"secondary\",\n        children: renderForm()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 147,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Comments, \"Y3V9cKOyrJcdHK1dDfGmwQNYDsY=\", false, function () {\n  return [useHistory];\n});\n\n_c = Comments;\nexport default Comments;\n\nvar _c;\n\n$RefreshReg$(_c, \"Comments\");","map":{"version":3,"sources":["/Users/jiyechoi/Desktop/KGSA_web/kgsa/frontend/src/components/Comments.js"],"names":["useEffect","useState","Col","Form","ListGroup","Row","Alert","RiDeleteBin2Line","RiEditLine","getToken","getUser","StyledButton","BsChatQuote","useHistory","url","user","userCompare","username","localeCompare","Comments","forumItem","_id","comments","setComments","newComment","setNewComment","comment","inputKey","setInputKey","editing","setEditing","history","handleChange","e","target","value","handleOnSubmit","preventDefault","addNewComment","updateCommnet","fetchData","requestOptions","method","redirect","fetch","then","response","json","result","data","catch","error","console","log","myHeaders","Headers","append","headers","body","JSON","stringify","text","res","cid","deleteComment","renderForm","component","textAlign","push","map","item","i","fontSize","updatedAt","split","substring"],"mappings":"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","sourcesContent":["// import { Button } from \"bootstrap\";s\n\nimport { useEffect, useState } from \"react\"\nimport { Col, Form, ListGroup, Row,Alert } from \"react-bootstrap\"\nimport { RiDeleteBin2Line,RiEditLine} from 'react-icons/ri';\nimport { getToken, getUser } from \"../services/LoginHelper\";\nimport { StyledButton } from \"./Styles\";\nimport {BsChatQuote} from 'react-icons/bs';\nimport { useHistory } from \"react-router-dom\";\nimport {url} from '../services/config';\n\nconst user = getUser();\nconst userCompare=(username)=>{\n    return !user.username.localeCompare(username);\n}\n\nconst Comments = ({forumItem, _id})=>{\n    const user = getUser();\n    const [comments, setComments] = useState([])\n    const [newComment, setNewComment] = useState({\n        username : user? user.username : \"\",\n        comment : \"\"\n    })\n\n    const [inputKey, setInputKey]= useState(\"inputKey\");\n    const [ editing,setEditing] = useState(false);\n    const history = useHistory();\n\n    const handleChange=(e)=>{\n        setNewComment({\n            ...newComment, comment : e.target.value\n        })\n    }\n\n    const handleOnSubmit =(e)=>{\n        e.preventDefault();\n        if(!editing){\n            addNewComment();\n        }else{\n            updateCommnet(newComment._id)\n        }\n        // setInputKey(e.target.value);\n    }\n\n    const fetchData = ()=>{\n        var requestOptions = {\n            method: 'GET',\n            redirect: 'follow'\n          };\n\n        fetch(`${url}${forumItem}/comments/${_id}`, requestOptions)\n        .then(response => response.json())\n        .then(result => {\n            setComments(result.data)\n        })\n        .catch(error => console.log('error', error));\n    }\n\n    const addNewComment = ()=>{\n\n        var myHeaders = new Headers();\n        myHeaders.append(\"Content-Type\", \"application/json\");\n        var requestOptions = {\n            method: 'POST',\n            headers: myHeaders,\n            body: JSON.stringify(newComment),\n            redirect: 'follow'\n          };\n          \n          fetch(`${url}${forumItem}/comments/${_id}`, requestOptions)\n            .then(response => response.text())\n            .then(res=> setInputKey(res))\n            .catch(error => console.log('error', error));\n    } \n\n    const updateCommnet = (cid)=>{\n        console.log(\"?\")\n        var myHeaders = new Headers();\n        myHeaders.append(\"Content-Type\", \"application/json\");\n\n        var requestOptions = {\n            method: 'PUT',\n            headers: myHeaders,\n            body : JSON.stringify(newComment),\n            redirect: 'follow'\n          };\n          \n          fetch(`${url}${forumItem}/comments/${_id}/${cid}`, requestOptions)\n            .then(response => response.text())\n            .then(res=> setInputKey(res))\n            .catch(error => console.log('error', error));\n\n        setEditing(false)\n    }\n\n    const deleteComment = (cid)=>{\n        var requestOptions = {\n            method: 'DELETE',\n            redirect: 'follow'\n          };\n          \n          fetch(`${url}${forumItem}/comments/${_id}/${cid}`, requestOptions)\n            .then(response => response.text())\n            .then(res=> setInputKey(res))\n            .catch(error => console.log('error', error));\n        \n        setEditing(false)\n    }\n\n    useEffect(()=>{\n        fetchData()\n    },[inputKey])\n\n    const renderForm = ()=>{\n        var value = \"\"\n        let component = null\n\n        if(!getToken()){\n            component = (<Alert variant=\"danger\" style={{textAlign:'center'}}>\n                            <p>Please Login to make a comment</p>\n                            <StyledButton onClick={()=>history.push('/login')}>Go to Login</StyledButton>\n                        </Alert>)\n        }\n        else {\n            component = (<Form onSubmit={handleOnSubmit}>\n                            <Form.Group>\n                                <Form.Label>\n                                    {!editing? \"New comment\" : \"Edit comment\"}\n                                </Form.Label>                   \n                                    <Form.Control \n                                        as=\"textarea\"\n                                        placeholder=\"Kindness and politeness are not overrated at all.\" \n                                        rows={3} \n                                        name=\"comment\" \n                                        onChange={handleChange}\n                                        defaultValue={editing? newComment.comment : null}\n                                        key={inputKey}\n                                    />\n                            </Form.Group>\n                            <StyledButton type=\"submit\" float=\"right\">Submit</StyledButton>\n                        </Form>)\n        }\n        return component\n\n    }\n    return (\n        <div>\n            <ListGroup>\n                {comments.map((item,i)=>{\n                        return (\n                            <ListGroup.Item key={i} variant=\"secondary\">\n                                <Row className=\"align-items-center\">\n                                    <Col xs={2}>\n                                        <BsChatQuote style={{fontSize:\"25pt\"}}/>\n                                    </Col>\n                                    <Col  xs={7}>\n                                        <Row style={{fontSize:\"10pt\"}}>\n                                            user: {item.username}\n                                        </Row>\n                                        <Row  style={{fontSize:\"12pt\"}}>\n                                            {item.comment}\n                                        </Row>\n                                    </Col>\n                                    <Col xs={2} style={{fontSize:\"10pt\"}}>\n                                        <Row>작성시간</Row>\n                                        <Row>\n                                            {item.updatedAt.split('T')[0]}\n                                        </Row>\n                                        <Row>\n                                            {item.updatedAt.split('T')[1].substring(0,11)}\n                                        </Row>\n                                    </Col>\n                                    <Col xs={1}>\n                                        {user && userCompare(item.username)?\n                                            <>\n                                                <RiDeleteBin2Line onClick={()=>{deleteComment(item._id)}}/>\n                                                <RiEditLine onClick={()=>{setEditing(true); setNewComment(item)}}/>\n                                            </>\n                                        : null}\n                                    </Col>\n                                </Row>\n                            </ListGroup.Item>\n                        )\n                    })}\n                <ListGroup.Item variant=\"secondary\">\n                    {renderForm()}\n                </ListGroup.Item> \n            </ListGroup>\n        </div>\n    )\n}\n\nexport default Comments;\n"]},"metadata":{},"sourceType":"module"}